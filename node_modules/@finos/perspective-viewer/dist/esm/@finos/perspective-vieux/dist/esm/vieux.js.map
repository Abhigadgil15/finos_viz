{"version":3,"file":"vieux.js","sources":["../../src/js/vieux.js"],"sourcesContent":["/******************************************************************************\n *\n * Copyright (c) 2018, the Perspective Authors.\n *\n * This file is part of the Perspective library, distributed under the terms\n * of the Apache License 2.0.  The full license can be found in the LICENSE\n * file.\n *\n */\n\nimport init, * as internal from \"../../pkg/perspective_vieux.js\";\nimport wasm_internal from \"../../pkg/perspective_vieux_bg.wasm\";\n\nexport const wasm = init(wasm_internal).then(() => {\n    internal.set_panic_hook();\n    return internal;\n});\n\nlet _index = undefined;\nasync function _await_index(f) {\n    await new Promise(setTimeout);\n    if (!_index) {\n        _index = await wasm;\n    }\n    return f();\n}\n\n// function handle_view_errors(e) {\n//     if (e.message !== \"View is not initialized\") {\n//         throw e;\n//     }\n// }\n\nclass PerspectiveVieuxElement extends HTMLElement {\n    constructor() {\n        super();\n        _await_index(() => {\n            this._instance = new _index.PerspectiveVieuxElement(this);\n        });\n    }\n\n    connectedCallback() {\n        _await_index(() => {\n            this._instance.connected_callback();\n        });\n    }\n\n    load(table) {\n        _await_index(() => this._instance.load(table));\n    }\n\n    set_view(view) {\n        _await_index(() => this._instance.set_view(view));\n    }\n\n    delete_view() {\n        return _await_index(() => this._instance.delete_view());\n    }\n\n    toggle_config(force) {\n        return _await_index(() => this._instance.toggle_config(force));\n    }\n\n    _open_expression_editor(target) {\n        return _await_index(() => this._instance._open_expression_editor(target));\n    }\n}\n\nif (document.createElement(\"perspective-vieux\").constructor === HTMLElement) {\n    window.customElements.define(\"perspective-vieux\", PerspectiveVieuxElement);\n}\n\nclass PerspectiveColumnStyleElement extends HTMLElement {\n    constructor() {\n        super();\n    }\n\n    open(target, config, default_config) {\n        _await_index(() => {\n            if (this._instance) {\n                this._instance.reset(config, default_config);\n            } else {\n                this._instance = new _index.PerspectiveColumnStyleElement(this, config, default_config);\n            }\n\n            this._instance.open(target);\n        });\n    }\n}\n\nif (document.createElement(\"perspective-column-style\").constructor === HTMLElement) {\n    window.customElements.define(\"perspective-column-style\", PerspectiveColumnStyleElement);\n}\n"],"names":["wasm","init","wasm_internal","then","internal","_index","undefined","_await_index","f","Promise","setTimeout","PerspectiveVieuxElement","constructor","_instance","connectedCallback","connected_callback","load","table","set_view","view","delete_view","toggle_config","force","_open_expression_editor","target","document","createElement","HTMLElement","window","customElements","define","PerspectiveColumnStyleElement","open","config","default_config","reset"],"mappings":";;;;;;;;;MAaaA,IAAI,GAAGC,iBAAI,CAACC,aAAD,CAAJ,CAAoBC,IAApB,CAAyB,MAAM;AAC/CC,EAAAA,cAAA;AACA,SAAOA,QAAP;AACH,CAHmB;AAKpB,IAAIC,MAAM,GAAGC,SAAb;;AACA,eAAeC,YAAf,CAA4BC,CAA5B,EAA+B;AAC3B,QAAM,IAAIC,OAAJ,CAAYC,UAAZ,CAAN;;AACA,MAAI,CAACL,MAAL,EAAa;AACTA,IAAAA,MAAM,GAAG,MAAML,IAAf;AACH;;AACD,SAAOQ,CAAC,EAAR;AACH;AAGD;AACA;AACA;AACA;;;AAEA,MAAMG,uBAAN,wBAAkD;AAC9CC,EAAAA,WAAW,GAAG;AACV;;AACAL,IAAAA,YAAY,CAAC,MAAM;AACf,WAAKM,SAAL,GAAiB,IAAIR,MAAM,CAACM,uBAAX,CAAmC,IAAnC,CAAjB;AACH,KAFW,CAAZ;AAGH;;AAEDG,EAAAA,iBAAiB,GAAG;AAChBP,IAAAA,YAAY,CAAC,MAAM;AACf,WAAKM,SAAL,CAAeE,kBAAf;AACH,KAFW,CAAZ;AAGH;;AAEDC,EAAAA,IAAI,CAACC,KAAD,EAAQ;AACRV,IAAAA,YAAY,CAAC,MAAM,KAAKM,SAAL,CAAeG,IAAf,CAAoBC,KAApB,CAAP,CAAZ;AACH;;AAEDC,EAAAA,QAAQ,CAACC,IAAD,EAAO;AACXZ,IAAAA,YAAY,CAAC,MAAM,KAAKM,SAAL,CAAeK,QAAf,CAAwBC,IAAxB,CAAP,CAAZ;AACH;;AAEDC,EAAAA,WAAW,GAAG;AACV,WAAOb,YAAY,CAAC,MAAM,KAAKM,SAAL,CAAeO,WAAf,EAAP,CAAnB;AACH;;AAEDC,EAAAA,aAAa,CAACC,KAAD,EAAQ;AACjB,WAAOf,YAAY,CAAC,MAAM,KAAKM,SAAL,CAAeQ,aAAf,CAA6BC,KAA7B,CAAP,CAAnB;AACH;;AAEDC,EAAAA,uBAAuB,CAACC,MAAD,EAAS;AAC5B,WAAOjB,YAAY,CAAC,MAAM,KAAKM,SAAL,CAAeU,uBAAf,CAAuCC,MAAvC,CAAP,CAAnB;AACH;;AAhC6C;;AAmClD,IAAIC,QAAQ,CAACC,aAAT,CAAuB,mBAAvB,EAA4Cd,WAA5C,KAA4De,WAAhE,EAA6E;AACzEC,EAAAA,MAAM,CAACC,cAAP,CAAsBC,MAAtB,CAA6B,mBAA7B,EAAkDnB,uBAAlD;AACH;;AAED,MAAMoB,6BAAN,wBAAwD;AACpDnB,EAAAA,WAAW,GAAG;AACV;AACH;;AAEDoB,EAAAA,IAAI,CAACR,MAAD,EAASS,MAAT,EAAiBC,cAAjB,EAAiC;AACjC3B,IAAAA,YAAY,CAAC,MAAM;AACf,UAAI,KAAKM,SAAT,EAAoB;AAChB,aAAKA,SAAL,CAAesB,KAAf,CAAqBF,MAArB,EAA6BC,cAA7B;AACH,OAFD,MAEO;AACH,aAAKrB,SAAL,GAAiB,IAAIR,MAAM,CAAC0B,6BAAX,CAAyC,IAAzC,EAA+CE,MAA/C,EAAuDC,cAAvD,CAAjB;AACH;;AAED,WAAKrB,SAAL,CAAemB,IAAf,CAAoBR,MAApB;AACH,KARW,CAAZ;AASH;;AAfmD;;AAkBxD,IAAIC,QAAQ,CAACC,aAAT,CAAuB,0BAAvB,EAAmDd,WAAnD,KAAmEe,WAAvE,EAAoF;AAChFC,EAAAA,MAAM,CAACC,cAAP,CAAsBC,MAAtB,CAA6B,0BAA7B,EAAyDC,6BAAzD;AACH;;;;"}